# Migration `20200520174701-full-data`

This migration has been generated by Will Bunting at 5/20/2020, 5:47:01 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
DROP INDEX "public"."Location.slug"

CREATE TABLE "public"."Parameter" (
"citations" text []  ,"description" text  NOT NULL ,"id" SERIAL,"locationId" integer   ,"name" text  NOT NULL ,"type" text  NOT NULL ,"value" Decimal(65,30)  NOT NULL ,
    PRIMARY KEY ("id"))

ALTER TABLE "public"."Location" DROP COLUMN "slug",
ADD COLUMN "dateModelRun" text  NOT NULL ,
ADD COLUMN "icuBeds" integer  NOT NULL ,
ADD COLUMN "importtime" Decimal(65,30)  NOT NULL ,
ADD COLUMN "mostRecentDistancingDate" text  NOT NULL ,
ADD COLUMN "name" text  NOT NULL ,
ADD COLUMN "population" integer  NOT NULL ,
ADD COLUMN "r0" Decimal(65,30)  NOT NULL ,
ADD COLUMN "ventilators" integer  NOT NULL ;

ALTER TABLE "public"."Scenario" ADD COLUMN "dateContained" text  NOT NULL ,
ADD COLUMN "dateHospitalsOverCapacity" text  NOT NULL ,
ADD COLUMN "dateICUOverCapacity" text  NOT NULL ,
ADD COLUMN "distancingDays" integer  NOT NULL ,
ADD COLUMN "distancingLevel" Decimal(65,30)  NOT NULL ,
ADD COLUMN "fatalityRate" Decimal(65,30)  NOT NULL ,
ADD COLUMN "fatalityRatePCR" Decimal(65,30)  NOT NULL ,
ADD COLUMN "fatalityRateSymptomatic" Decimal(65,30)  NOT NULL ,
ADD COLUMN "fractionDeathOfHospitalizedOrICU" Decimal(65,30)  NOT NULL ,
ADD COLUMN "fractionHospitalizedInICU" Decimal(65,30)  NOT NULL ,
ADD COLUMN "fractionOfDeathInICU" Decimal(65,30)  NOT NULL ,
ADD COLUMN "fractionOfDeathsReported" Decimal(65,30)  NOT NULL ,
ADD COLUMN "fractionOfHospitalizationsReported" Decimal(65,30)  NOT NULL ,
ADD COLUMN "fractionOfInfectionsPCRConfirmed" Decimal(65,30)  NOT NULL ,
ADD COLUMN "fractionOfPCRHospitalized" Decimal(65,30)  NOT NULL ,
ADD COLUMN "fractionOfPCRHospitalizedOrICU" Decimal(65,30)  NOT NULL ,
ADD COLUMN "fractionOfSymptomaticHospitalized" Decimal(65,30)  NOT NULL ,
ADD COLUMN "fractionOfSymptomaticHospitalizedOrICU" Decimal(65,30)  NOT NULL ,
ADD COLUMN "name" text  NOT NULL ,
ADD COLUMN "totalInfectedFraction" Decimal(65,30)  NOT NULL ;

CREATE UNIQUE INDEX "Location.name" ON "public"."Location"("name")

ALTER TABLE "public"."Parameter" ADD FOREIGN KEY ("locationId")REFERENCES "public"."Location"("id") ON DELETE SET NULL  ON UPDATE CASCADE
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration 20200520173203-real-schema..20200520174701-full-data
--- datamodel.dml
+++ datamodel.dml
@@ -1,6 +1,6 @@
 datasource postgresql {
-  url = "***"
+  url      = env("DATABASE_URL")
   provider = "postgresql"
 }
 generator client {
@@ -15,15 +15,54 @@
   scenarioId Int?
 }
 model Scenario {
-  id         Int       @default(autoincrement()) @id
-  series     Series[]
-  Location   Location? @relation(fields: [locationId], references: [id])
-  locationId Int?
+  id                                     Int       @default(autoincrement()) @id
+  name                                   String
+  dateContained                          String
+  dateHospitalsOverCapacity              String
+  dateICUOverCapacity                    String
+  totalInfectedFraction                  Float
+  fatalityRate                           Float
+  fatalityRateSymptomatic                Float
+  fatalityRatePCR                        Float
+  fractionOfSymptomaticHospitalized      Float
+  fractionOfSymptomaticHospitalizedOrICU Float
+  fractionOfPCRHospitalized              Float
+  fractionOfPCRHospitalizedOrICU         Float
+  fractionHospitalizedInICU              Float
+  fractionOfDeathInICU                   Float
+  fractionDeathOfHospitalizedOrICU       Float
+  fractionOfInfectionsPCRConfirmed       Float
+  fractionOfDeathsReported               Float
+  fractionOfHospitalizationsReported     Float
+  distancingDays                         Int
+  distancingLevel                        Float
+  series                                 Series[]
+  Location                               Location? @relation(fields: [locationId], references: [id])
+  locationId                             Int?
 }
+model Parameter {
+  id          Int       @default(autoincrement()) @id
+  value       Float
+  name        String
+  description String
+  type        String
+  citations   String[]
+  Location    Location? @relation(fields: [locationId], references: [id])
+  locationId  Int?
+}
+
 model Location {
-  id        Int        @default(autoincrement()) @id
-  slug      String     @unique
-  scenarios Scenario[]
+  id                       Int         @default(autoincrement()) @id
+  name                     String      @unique
+  dateModelRun             String
+  icuBeds                  Int
+  importtime               Float
+  mostRecentDistancingDate String
+  population               Int
+  r0                       Float
+  ventilators              Int
+  scenarios                Scenario[]
+  parameters               Parameter[]
 }
```


